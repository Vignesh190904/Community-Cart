{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/BottomNavbar.tsx"],"sourcesContent":["import { useRouter } from 'next/router';\r\nimport Link from 'next/link';\r\n\r\nconst NAV_ITEMS = [\r\n    { href: '/customer/home', label: 'Home', icon: '/customer/assets/icons/home.svg' },\r\n    { href: '/customer/browse-products', label: 'Search', icon: '/customer/assets/icons/search.svg' },\r\n    { href: '/customer/cart', label: 'Cart', icon: '/customer/assets/icons/cart.svg' },\r\n    { href: '/customer/orders', label: 'Orders', icon: '/customer/assets/icons/order.svg' },\r\n    { href: '/customer/profile', label: 'Profile', icon: '/customer/assets/icons/profile.svg' },\r\n];\r\n\r\nexport default function BottomNavbar() {\r\n    const router = useRouter();\r\n\r\n    return (\r\n        <nav className=\"customer-bottom-nav\">\r\n            {NAV_ITEMS.map((item) => {\r\n                // Precise active check: \r\n                // Home only matches exactly, others match by prefix to handle sub-routes\r\n                const is_active = item.href === '/customer/home'\r\n                    ? router.pathname === item.href\r\n                    : router.pathname.startsWith(item.href);\r\n\r\n                return (\r\n                    <Link\r\n                        key={item.href}\r\n                        href={item.href}\r\n                        className={`bottom-nav-item ${is_active ? 'active' : ''}`}\r\n                    >\r\n                        <img\r\n                            src={item.icon}\r\n                            alt={item.label}\r\n                            className=\"nav-icon-img\"\r\n                        />\r\n                    </Link>\r\n                );\r\n            })}\r\n        </nav>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,YAAY;IACd;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAA6B,OAAO;QAAU,MAAM;IAAoC;IAChG;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAAoB,OAAO;QAAU,MAAM;IAAmC;IACtF;QAAE,MAAM;QAAqB,OAAO;QAAW,MAAM;IAAqC;CAC7F;AAEc,SAAS;IACpB,MAAM,SAAS,IAAA,gLAAS;IAExB,qBACI,qKAAC;QAAI,WAAU;kBACV,UAAU,GAAG,CAAC,CAAC;YACZ,yBAAyB;YACzB,yEAAyE;YACzE,MAAM,YAAY,KAAK,IAAI,KAAK,mBAC1B,OAAO,QAAQ,KAAK,KAAK,IAAI,GAC7B,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,IAAI;YAE1C,qBACI,qKAAC,4KAAI;gBAED,MAAM,KAAK,IAAI;gBACf,WAAW,CAAC,gBAAgB,EAAE,YAAY,WAAW,IAAI;0BAEzD,cAAA,qKAAC;oBACG,KAAK,KAAK,IAAI;oBACd,KAAK,KAAK,KAAK;oBACf,WAAU;;;;;;eAPT,KAAK,IAAI;;;;;QAW1B;;;;;;AAGZ"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/CustomerLayout.tsx"],"sourcesContent":["import Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, useState } from 'react';\r\nimport BottomNavbar from '../../pages/customer/BottomNavbar';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nexport default function CustomerLayout({\r\n  children,\r\n  disablePadding = false,\r\n  fullWidth = false\r\n}: {\r\n  children: React.ReactNode;\r\n  disablePadding?: boolean;\r\n  fullWidth?: boolean\r\n}) {\r\n  const router = useRouter();\r\n  const { is_authenticated, loading } = useAuth();\r\n  const [isDark, setIsDark] = useState<boolean>(false);\r\n\r\n  // 1. THEME LOGIC\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const theme = localStorage.getItem('cc_theme');\r\n      const prefersDark = theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n      setIsDark(prefersDark);\r\n      if (prefersDark) {\r\n        document.body.classList.add('theme-dark');\r\n      } else {\r\n        document.body.classList.remove('theme-dark');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // 2. THEME TOGGLE EXPORT\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      (window as any).toggleCustomerTheme = () => {\r\n        const newTheme = !isDark;\r\n        setIsDark(newTheme);\r\n        if (newTheme) {\r\n          document.body.classList.add('theme-dark');\r\n          localStorage.setItem('cc_theme', 'dark');\r\n        } else {\r\n          document.body.classList.remove('theme-dark');\r\n          localStorage.setItem('cc_theme', 'light');\r\n        }\r\n      };\r\n    }\r\n  }, [isDark]);\r\n\r\n  // 3. GLOBAL AUTHENTICATION GUARD\r\n  useEffect(() => {\r\n    // Prevent auto-logout/redirect loop by waiting for AuthContext to finish loading\r\n    if (!loading) {\r\n      if (!is_authenticated) {\r\n        // No valid session found after revalidation\r\n        router.replace('/customer/signin');\r\n      }\r\n      // Onboarding redirect logic removed - users navigate directly to Home after signup\r\n    }\r\n  }, [is_authenticated, loading, router]);\r\n\r\n  // 4. LOADING STATE\r\n  // Show a clean loading screen while AuthContext verifies the token/cookie\r\n  if (loading) {\r\n    return (\r\n      <div style={{\r\n        height: '100vh',\r\n        width: '100vw',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: isDark ? '#121212' : '#ffffff',\r\n        color: isDark ? '#ffffff' : '#000000',\r\n        fontFamily: 'sans-serif'\r\n      }}>\r\n        <div style={{ textAlign: 'center' }}>\r\n          <p style={{ fontWeight: '500', fontSize: '16px' }}>Securely loading session...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 5. RENDER PROTECTION\r\n  // If not authenticated and finished loading, render nothing while redirecting\r\n  if (!is_authenticated) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`customer-shell ${fullWidth ? 'full-width' : ''}`}>\r\n      <main className={`customer-main ${disablePadding ? 'no-padding' : ''} page-transition`}>\r\n        {children}\r\n      </main>\r\n      <BottomNavbar />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAEe,SAAS,eAAe,EACrC,QAAQ,EACR,iBAAiB,KAAK,EACtB,YAAY,KAAK,EAKlB;IACC,MAAM,SAAS,IAAA,gLAAS;IACxB,MAAM,EAAE,gBAAgB,EAAE,OAAO,EAAE,GAAG,IAAA,8KAAO;IAC7C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAU;IAE9C,iBAAiB;IACjB,IAAA,gHAAS,EAAC;QACR;;IAUF,GAAG,EAAE;IAEL,yBAAyB;IACzB,IAAA,gHAAS,EAAC;QACR;;IAaF,GAAG;QAAC;KAAO;IAEX,iCAAiC;IACjC,IAAA,gHAAS,EAAC;QACR,iFAAiF;QACjF,IAAI,CAAC,SAAS;YACZ,IAAI,CAAC,kBAAkB;gBACrB,4CAA4C;gBAC5C,OAAO,OAAO,CAAC;YACjB;QACA,mFAAmF;QACrF;IACF,GAAG;QAAC;QAAkB;QAAS;KAAO;IAEtC,mBAAmB;IACnB,0EAA0E;IAC1E,IAAI,SAAS;QACX,qBACE,qKAAC;YAAI,OAAO;gBACV,QAAQ;gBACR,OAAO;gBACP,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,iBAAiB,SAAS,YAAY;gBACtC,OAAO,SAAS,YAAY;gBAC5B,YAAY;YACd;sBACE,cAAA,qKAAC;gBAAI,OAAO;oBAAE,WAAW;gBAAS;0BAChC,cAAA,qKAAC;oBAAE,OAAO;wBAAE,YAAY;wBAAO,UAAU;oBAAO;8BAAG;;;;;;;;;;;;;;;;IAI3D;IAEA,uBAAuB;IACvB,8EAA8E;IAC9E,IAAI,CAAC,kBAAkB;QACrB,OAAO;IACT;IAEA,qBACE,qKAAC;QAAI,WAAW,CAAC,eAAe,EAAE,YAAY,eAAe,IAAI;;0BAC/D,qKAAC;gBAAK,WAAW,CAAC,cAAc,EAAE,iBAAiB,eAAe,GAAG,gBAAgB,CAAC;0BACnF;;;;;;0BAEH,qKAAC,yLAAY;;;;;;;;;;;AAGnB"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/SkeletonProductCard.tsx"],"sourcesContent":["import React from 'react';\r\n\r\nexport const SkeletonProductCard = () => (\r\n    <div className=\"product-card\">\r\n        <div className=\"product-card-header\" style={{ justifyContent: 'flex-end', padding: '8px' }}>\r\n            <div className=\"skeleton\" style={{ width: '24px', height: '24px', borderRadius: '50%' }}></div>\r\n        </div>\r\n\r\n        <div className=\"product-image-wrapper\">\r\n            <div className=\"skeleton\" style={{ width: '100%', height: '100%' }}></div>\r\n        </div>\r\n\r\n        <div className=\"product-card-body\">\r\n            <div className=\"skeleton skeleton-text\" style={{ width: '80%', height: '1.2em' }}></div>\r\n            <div className=\"skeleton skeleton-text\" style={{ width: '40%', height: '1em' }}></div>\r\n            <div className=\"product-price-wrapper\">\r\n                <div className=\"skeleton skeleton-text\" style={{ width: '30%', height: '1.2em' }}></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div className=\"product-card-footer\">\r\n            <div className=\"skeleton\" style={{ width: '100%', height: '36px', borderRadius: '6px' }}></div>\r\n        </div>\r\n    </div>\r\n);\r\n"],"names":[],"mappings":";;;;;;AAEO,MAAM,sBAAsB,kBAC/B,qKAAC;QAAI,WAAU;;0BACX,qKAAC;gBAAI,WAAU;gBAAsB,OAAO;oBAAE,gBAAgB;oBAAY,SAAS;gBAAM;0BACrF,cAAA,qKAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,OAAO;wBAAQ,QAAQ;wBAAQ,cAAc;oBAAM;;;;;;;;;;;0BAG1F,qKAAC;gBAAI,WAAU;0BACX,cAAA,qKAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,OAAO;wBAAQ,QAAQ;oBAAO;;;;;;;;;;;0BAGrE,qKAAC;gBAAI,WAAU;;kCACX,qKAAC;wBAAI,WAAU;wBAAyB,OAAO;4BAAE,OAAO;4BAAO,QAAQ;wBAAQ;;;;;;kCAC/E,qKAAC;wBAAI,WAAU;wBAAyB,OAAO;4BAAE,OAAO;4BAAO,QAAQ;wBAAM;;;;;;kCAC7E,qKAAC;wBAAI,WAAU;kCACX,cAAA,qKAAC;4BAAI,WAAU;4BAAyB,OAAO;gCAAE,OAAO;gCAAO,QAAQ;4BAAQ;;;;;;;;;;;;;;;;;0BAIvF,qKAAC;gBAAI,WAAU;0BACX,cAAA,qKAAC;oBAAI,WAAU;oBAAW,OAAO;wBAAE,OAAO;wBAAQ,QAAQ;wBAAQ,cAAc;oBAAM"}},
    {"offset": {"line": 322, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/TopNavbar.tsx"],"sourcesContent":["import { useRouter } from 'next/router';\r\nimport { ReactNode, useEffect, useState } from 'react';\r\n\r\ninterface RightAction {\r\n  label?: string;\r\n  icon?: ReactNode;\r\n  onClick: () => void;\r\n}\r\n\r\ninterface TopNavbarProps {\r\n  title: string;\r\n  showBack?: boolean;\r\n  onBack?: () => void;\r\n  rightAction?: RightAction | null;\r\n}\r\n\r\n// Hardcoded back navigation mapping (demo-grade)\r\nconst getBackDestination = (pathname: string, query: Record<string, string | string[] | undefined>): string | null => {\r\n  const fromParam = query.from as string | undefined;\r\n\r\n  switch (pathname) {\r\n    case '/customer/profile':\r\n      return '/customer/home';\r\n    case '/customer/browse-products':\r\n      return '/customer/home';\r\n    case '/customer/category':\r\n      // If accessed from browse-products, go back there; otherwise home\r\n      return fromParam === 'browse' ? '/customer/browse-products' : '/customer/home';\r\n    case '/customer/favorites':\r\n      return '/customer/home';\r\n    case '/customer/cart':\r\n      return '/customer/home';\r\n    case '/customer/checkout':\r\n      return '/customer/cart';\r\n    case '/customer/orders':\r\n      return '/customer/home';\r\n    case '/customer/address':\r\n      return '/customer/profile';\r\n    case '/customer/edit-address':\r\n      return '/customer/profile';\r\n    case '/customer/edit-profile':\r\n      return '/customer/profile';\r\n    default:\r\n      // For product detail and other pages, use router.back()\r\n      return null;\r\n  }\r\n};\r\n\r\nexport default function TopNavbar({\r\n  title,\r\n  showBack = true,\r\n  onBack,\r\n  rightAction = null,\r\n}: TopNavbarProps) {\r\n  const router = useRouter();\r\n  const [mounted, setMounted] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  const handleBack = () => {\r\n    if (onBack) {\r\n      onBack();\r\n      return;\r\n    }\r\n\r\n    const destination = getBackDestination(router.pathname, router.query);\r\n    if (destination) {\r\n      router.push(destination);\r\n    } else {\r\n      router.back();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <header className={`top-navbar ${mounted ? 'top-navbar--visible' : ''}`}>\r\n      <div className=\"top-navbar__left\">\r\n        {showBack && (\r\n          <button\r\n            className=\"top-navbar__back-btn\"\r\n            onClick={handleBack}\r\n            aria-label=\"Go back\"\r\n          >\r\n            <svg\r\n              width=\"24\"\r\n              height=\"24\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n            >\r\n              <path d=\"M15 18l-6-6 6-6\" />\r\n            </svg>\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <h1 className=\"top-navbar__title\">{title}</h1>\r\n\r\n      <div className=\"top-navbar__right\">\r\n        {rightAction && (\r\n          <button\r\n            className=\"top-navbar__action-btn\"\r\n            onClick={rightAction.onClick}\r\n            aria-label={rightAction.label || 'Action'}\r\n          >\r\n            {rightAction.icon ? (\r\n              rightAction.icon\r\n            ) : rightAction.label ? (\r\n              <span className=\"top-navbar__action-label\">{rightAction.label}</span>\r\n            ) : null}\r\n          </button>\r\n        )}\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAeA,iDAAiD;AACjD,MAAM,qBAAqB,CAAC,UAAkB;IAC5C,MAAM,YAAY,MAAM,IAAI;IAE5B,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,kEAAkE;YAClE,OAAO,cAAc,WAAW,8BAA8B;QAChE,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,wDAAwD;YACxD,OAAO;IACX;AACF;AAEe,SAAS,UAAU,EAChC,KAAK,EACL,WAAW,IAAI,EACf,MAAM,EACN,cAAc,IAAI,EACH;IACf,MAAM,SAAS,IAAA,gLAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,IAAA,gHAAS,EAAC;QACR,WAAW;IACb,GAAG,EAAE;IAEL,MAAM,aAAa;QACjB,IAAI,QAAQ;YACV;YACA;QACF;QAEA,MAAM,cAAc,mBAAmB,OAAO,QAAQ,EAAE,OAAO,KAAK;QACpE,IAAI,aAAa;YACf,OAAO,IAAI,CAAC;QACd,OAAO;YACL,OAAO,IAAI;QACb;IACF;IAEA,qBACE,qKAAC;QAAO,WAAW,CAAC,WAAW,EAAE,UAAU,wBAAwB,IAAI;;0BACrE,qKAAC;gBAAI,WAAU;0BACZ,0BACC,qKAAC;oBACC,WAAU;oBACV,SAAS;oBACT,cAAW;8BAEX,cAAA,qKAAC;wBACC,OAAM;wBACN,QAAO;wBACP,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAY;wBACZ,eAAc;wBACd,gBAAe;kCAEf,cAAA,qKAAC;4BAAK,GAAE;;;;;;;;;;;;;;;;;;;;;0BAMhB,qKAAC;gBAAG,WAAU;0BAAqB;;;;;;0BAEnC,qKAAC;gBAAI,WAAU;0BACZ,6BACC,qKAAC;oBACC,WAAU;oBACV,SAAS,YAAY,OAAO;oBAC5B,cAAY,YAAY,KAAK,IAAI;8BAEhC,YAAY,IAAI,GACf,YAAY,IAAI,GACd,YAAY,KAAK,iBACnB,qKAAC;wBAAK,WAAU;kCAA4B,YAAY,KAAK;;;;;+BAC3D;;;;;;;;;;;;;;;;;AAMhB"}},
    {"offset": {"line": 463, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/search_bar.tsx"],"sourcesContent":["import React from 'react';\r\n\r\ninterface SearchBarProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  placeholder?: string;\r\n}\r\n\r\nexport default function SearchBar({ value, onChange, placeholder = \"Search...\" }: SearchBarProps) {\r\n  return (\r\n    <div className=\"customer-search-bar\">\r\n      <img\r\n        src=\"/customer/assets/icons/search.svg\"\r\n        alt=\"Search\"\r\n        className=\"customer-search-icon\"\r\n      />\r\n      <input\r\n        type=\"text\"\r\n        className=\"customer-search-input\"\r\n        value={value}\r\n        onChange={(e) => onChange(e.target.value)}\r\n        placeholder={placeholder}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;;AAQe,SAAS,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,cAAc,WAAW,EAAkB;IAC9F,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBACC,KAAI;gBACJ,KAAI;gBACJ,WAAU;;;;;;0BAEZ,qKAAC;gBACC,MAAK;gBACL,WAAU;gBACV,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,aAAa;;;;;;;;;;;;AAIrB"}},
    {"offset": {"line": 504, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/category.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport CustomerLayout from '../../components/customer/CustomerLayout';\r\nimport { useToast } from '../../components/ui/ToastProvider';\r\nimport { useCustomerStore } from '../../context/CustomerStore';\r\nimport { customerFetch } from '../../utils/customerFetch';\r\nimport { SkeletonProductCard } from '../../components/customer/SkeletonProductCard';\r\nimport TopNavbar from './TopNavbar';\r\nimport SearchBar from './search_bar';\r\n\r\n// --- Product Interface ---\r\n\r\ninterface Product {\r\n    _id: string;\r\n    name: string;\r\n    description?: string;\r\n    price: number;\r\n    mrp?: number;\r\n    quantity?: number;\r\n    unit?: string;\r\n    category?: string;\r\n    image?: string;\r\n    isAvailable: boolean;\r\n    stock: number;\r\n    vendor?: {\r\n        _id: string;\r\n        storeName: string;\r\n        ownerName: string;\r\n        email: string;\r\n        isActive: boolean;\r\n    };\r\n    createdAt?: string;\r\n    updatedAt?: string;\r\n}\r\n\r\nconst API_BASE = 'http://localhost:5000/api';\r\n\r\nexport default function CategoryPage() {\r\n    const router = useRouter();\r\n    const { type } = router.query;\r\n    const { enqueueToast } = useToast();\r\n\r\n    // Global Cart Store\r\n    const { cart, addToCart, updateQuantity, removeFromCart } = useCustomerStore();\r\n\r\n    // State\r\n    const [wishlist, setWishlist] = useState<Set<string>>(new Set());\r\n    // Removed local cart state\r\n    const [products, setProducts] = useState<Product[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n\r\n    // Fetch products from API\r\n    useEffect(() => {\r\n        const fetchProducts = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const response = await customerFetch(`${API_BASE}/products`);\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to fetch products');\r\n                }\r\n\r\n                const data = await response.json();\r\n                // Filter only available products from active vendors\r\n                const availableProducts = data.filter((p: Product) =>\r\n                    p.isAvailable && p.stock > 0 && p.vendor?.isActive !== false\r\n                );\r\n                setProducts(availableProducts);\r\n            } catch (error) {\r\n                console.error('Error fetching products:', error);\r\n                enqueueToast('Failed to load products', 'error');\r\n                setProducts([]);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchProducts();\r\n    }, [enqueueToast]);\r\n\r\n    // Filter products by category first, then by search query\r\n    const categoryProducts = useMemo(() => {\r\n        if (!type) return products;\r\n        const categoryType = Array.isArray(type) ? type[0].toLowerCase() : type.toLowerCase();\r\n        return products.filter(p =>\r\n            p.category?.trim().toLowerCase() === categoryType\r\n        );\r\n    }, [type, products]);\r\n\r\n    const filteredProducts = useMemo(() => {\r\n        return categoryProducts.filter(product =>\r\n            product.name.toLowerCase().includes(searchQuery.toLowerCase())\r\n        );\r\n    }, [categoryProducts, searchQuery]);\r\n\r\n    const title = type ? (Array.isArray(type) ? type[0] : type) : 'Category';\r\n\r\n    // Fetch wishlist from API\r\n    useEffect(() => {\r\n        const fetchWishlist = async () => {\r\n            try {\r\n                const token = localStorage.getItem('auth_token');\r\n                if (!token) return;\r\n\r\n                const response = await customerFetch(`${API_BASE}/customers/wishlist`, {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    if (response.status === 401) {\r\n                        console.error('Unauthorized: Invalid or expired token');\r\n                        return;\r\n                    }\r\n                    throw new Error('Failed to fetch wishlist');\r\n                }\r\n\r\n                const data = await response.json();\r\n                // Extract product IDs from wishlist items\r\n                const wishlistedProductIds = new Set<string>(\r\n                    data.map((item: { product: { _id: string } }) => item.product._id)\r\n                );\r\n                setWishlist(wishlistedProductIds);\r\n            } catch (error) {\r\n                console.error('Error fetching wishlist:', error);\r\n                // Don't show error toast for wishlist fetch failure - it's not critical\r\n            }\r\n        };\r\n\r\n        fetchWishlist();\r\n    }, []);\r\n\r\n    // Interactions\r\n    const toggleWishlist = async (id: string) => {\r\n        const isCurrentlyWishlisted = wishlist.has(id);\r\n\r\n        // Optimistic UI update\r\n        const newWishlist = new Set(wishlist);\r\n        if (isCurrentlyWishlisted) {\r\n            newWishlist.delete(id);\r\n        } else {\r\n            newWishlist.add(id);\r\n        }\r\n        setWishlist(newWishlist);\r\n\r\n        try {\r\n            const token = localStorage.getItem('auth_token');\r\n            if (!token) {\r\n                enqueueToast('Please login to manage wishlist', 'error');\r\n                // Revert optimistic update\r\n                setWishlist(wishlist);\r\n                return;\r\n            }\r\n\r\n            if (isCurrentlyWishlisted) {\r\n                // Remove from wishlist\r\n                const response = await customerFetch(`${API_BASE}/customers/wishlist/${id}`, {\r\n                    method: 'DELETE',\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to remove from wishlist');\r\n                }\r\n                enqueueToast('Removed from wishlist', 'success');\r\n            } else {\r\n                // Add to wishlist\r\n                const response = await customerFetch(`${API_BASE}/customers/wishlist`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': `Bearer ${token}`\r\n                    },\r\n                    body: JSON.stringify({ productId: id })\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to add to wishlist');\r\n                }\r\n                enqueueToast('Added to wishlist', 'success');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error toggling wishlist:', error);\r\n            enqueueToast('Failed to update wishlist', 'error');\r\n            // Revert optimistic update on error\r\n            setWishlist(wishlist);\r\n        }\r\n    };\r\n\r\n    // Helper to get logic from global cart\r\n    const getCartQty = (productId: string) => {\r\n        const item = cart.find(i => i.product._id === productId);\r\n        return item ? item.quantity : 0;\r\n    };\r\n\r\n    const handleAddToCart = (product: Product) => {\r\n        const productLite = {\r\n            _id: product._id,\r\n            name: product.name,\r\n            price: product.price,\r\n            vendorName: product.vendor?.storeName,\r\n            image: product.image,\r\n            stock: product.stock,\r\n            category: product.category\r\n        };\r\n        addToCart(productLite);\r\n    };\r\n\r\n    return (\r\n        <CustomerLayout disablePadding={true}>\r\n            <TopNavbar title={title} showBack={true} />\r\n            <div className=\"category-page-container\">\r\n\r\n                {/* Search */}\r\n                <section className=\"category-search-section\">\r\n                    <SearchBar\r\n                        value={searchQuery}\r\n                        onChange={setSearchQuery}\r\n                    />\r\n                </section>\r\n\r\n                {/* Featured Products Header */}\r\n                <section className=\"category-products-section\">\r\n                    <div className=\"category-section-header\">\r\n                        <h3 className=\"category-section-title\">Featured Products</h3>\r\n                        <span className=\"category-section-action\"><img src=\"/customer/assets/icons/forward.svg\" alt=\"View all\" width={24} height={24} /></span>\r\n                    </div>\r\n\r\n                    {loading ? (\r\n                        <div className=\"products-grid\">\r\n                            {Array.from({ length: 8 }).map((_, idx) => (\r\n                                <SkeletonProductCard key={`skeleton-${idx}`} />\r\n                            ))}\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            {/* Product Grid */}\r\n                            <div className=\"products-grid\">\r\n                                {filteredProducts.map((product) => {\r\n                                    const qty = getCartQty(product._id);\r\n                                    const isWishlisted = wishlist.has(product._id);\r\n\r\n                                    // Calculate discount if MRP exists and is higher than price\r\n                                    const hasDiscount = product.mrp && product.mrp > product.price;\r\n                                    const discountPercent = hasDiscount\r\n                                        ? Math.round(((product.mrp! - product.price) / product.mrp!) * 100)\r\n                                        : 0;\r\n\r\n                                    return (\r\n                                        <div key={product._id} className=\"product-card\">\r\n                                            <div className=\"product-card-header\">\r\n                                                {hasDiscount && (\r\n                                                    <span className=\"product-badge discount\">\r\n                                                        -{discountPercent}%\r\n                                                    </span>\r\n                                                )}\r\n                                                {!hasDiscount && <span></span>}\r\n                                                <button\r\n                                                    className=\"product-wishlist-btn\"\r\n                                                    onClick={() => toggleWishlist(product._id)}\r\n                                                >\r\n                                                    <img\r\n                                                        src={isWishlisted ? \"/customer/assets/icons/favorite-filled.svg\" : \"/customer/assets/icons/favorite.svg\"}\r\n                                                        alt=\"Wishlist\"\r\n                                                        className={`favorite-heart-icon ${isWishlisted ? 'active' : ''}`}\r\n                                                        style={{ width: '24px', height: '24px' }}\r\n                                                    />\r\n                                                </button>\r\n                                            </div>\r\n\r\n                                            <div className=\"product-image-wrapper\" onClick={() => router.push(`/customer/product-detail?id=${product._id}`)}>\r\n                                                <img\r\n                                                    src={product.image || '/customer/assets/icons/missing.svg'}\r\n                                                    alt={product.name}\r\n                                                    className={product.image ? 'product-image' : 'product-image-missing'}\r\n                                                />\r\n                                            </div>\r\n\r\n                                            <div className=\"product-card-body\" onClick={() => router.push(`/customer/product-detail?id=${product._id}`)}>\r\n                                                <h4 className=\"product-name\">{product.name}</h4>\r\n                                                <p className=\"product-qty-label\">\r\n                                                    {product.quantity ? `${product.quantity} ${product.unit || ''}` : (product.category || 'Product')}\r\n                                                </p>\r\n                                                <div className=\"product-price-wrapper\">\r\n                                                    <span className=\"product-final-price\">₹{product.price.toFixed(2)}</span>\r\n                                                    {hasDiscount && (\r\n                                                        <span className=\"product-original-price\" style={{\r\n                                                            textDecoration: 'line-through',\r\n                                                            color: '#999',\r\n                                                            fontSize: '0.85em',\r\n                                                            marginLeft: '0.5rem'\r\n                                                        }}>\r\n                                                            ₹{product.mrp!.toFixed(2)}\r\n                                                        </span>\r\n                                                    )}\r\n                                                </div>\r\n                                            </div>\r\n\r\n                                            <div className=\"product-card-footer\">\r\n                                                {qty === 0 ? (\r\n                                                    <button\r\n                                                        className=\"product-add-btn\"\r\n                                                        onClick={() => handleAddToCart(product)}\r\n                                                    >\r\n                                                        <img src=\"/customer/assets/icons/bag.svg\" alt=\"Cart\" className=\"product-cart-icon\" />\r\n                                                        Add to cart\r\n                                                    </button>\r\n                                                ) : (\r\n                                                    <div className=\"product-qty-controls\">\r\n                                                        <button\r\n                                                            className=\"product-qty-btn\"\r\n                                                            onClick={() => {\r\n                                                                if (qty === 1) {\r\n                                                                    removeFromCart(product._id);\r\n                                                                } else {\r\n                                                                    updateQuantity(product._id, qty - 1);\r\n                                                                }\r\n                                                            }}\r\n                                                        >\r\n                                                            <img src=\"/customer/assets/icons/minus.svg\" alt=\"Decrease\" />\r\n                                                        </button>\r\n                                                        <span className=\"product-qty-value\">{qty}</span>\r\n                                                        <button\r\n                                                            className=\"product-qty-btn\"\r\n                                                            onClick={() => updateQuantity(product._id, qty + 1)}\r\n                                                        >\r\n                                                            <img src=\"/customer/assets/icons/plus.svg\" alt=\"Increase\" />\r\n                                                        </button>\r\n                                                    </div>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                            {filteredProducts.length === 0 && (\r\n                                <div style={{ padding: '20px', textAlign: 'center', color: '#888' }}>\r\n                                    No products found in this category.\r\n                                </div>\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </section>\r\n            </div>\r\n        </CustomerLayout>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}