{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/BottomNavbar.tsx"],"sourcesContent":["import { useRouter } from 'next/router';\r\nimport Link from 'next/link';\r\n\r\nconst NAV_ITEMS = [\r\n    { href: '/customer/home', label: 'Home', icon: '/customer/assets/icons/home.svg' },\r\n    { href: '/customer/browse-products', label: 'Search', icon: '/customer/assets/icons/search.svg' },\r\n    { href: '/customer/cart', label: 'Cart', icon: '/customer/assets/icons/cart.svg' },\r\n    { href: '/customer/orders', label: 'Orders', icon: '/customer/assets/icons/order.svg' },\r\n    { href: '/customer/profile', label: 'Profile', icon: '/customer/assets/icons/profile.svg' },\r\n];\r\n\r\nexport default function BottomNavbar() {\r\n    const router = useRouter();\r\n\r\n    return (\r\n        <nav className=\"customer-bottom-nav\">\r\n            {NAV_ITEMS.map((item) => {\r\n                // Precise active check: \r\n                // Home only matches exactly, others match by prefix to handle sub-routes\r\n                const is_active = item.href === '/customer/home'\r\n                    ? router.pathname === item.href\r\n                    : router.pathname.startsWith(item.href);\r\n\r\n                return (\r\n                    <Link\r\n                        key={item.href}\r\n                        href={item.href}\r\n                        className={`bottom-nav-item ${is_active ? 'active' : ''}`}\r\n                    >\r\n                        <img\r\n                            src={item.icon}\r\n                            alt={item.label}\r\n                            className=\"nav-icon-img\"\r\n                        />\r\n                    </Link>\r\n                );\r\n            })}\r\n        </nav>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,YAAY;IACd;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAA6B,OAAO;QAAU,MAAM;IAAoC;IAChG;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAAoB,OAAO;QAAU,MAAM;IAAmC;IACtF;QAAE,MAAM;QAAqB,OAAO;QAAW,MAAM;IAAqC;CAC7F;AAEc,SAAS;IACpB,MAAM,SAAS,IAAA,gLAAS;IAExB,qBACI,qKAAC;QAAI,WAAU;kBACV,UAAU,GAAG,CAAC,CAAC;YACZ,yBAAyB;YACzB,yEAAyE;YACzE,MAAM,YAAY,KAAK,IAAI,KAAK,mBAC1B,OAAO,QAAQ,KAAK,KAAK,IAAI,GAC7B,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,IAAI;YAE1C,qBACI,qKAAC,4KAAI;gBAED,MAAM,KAAK,IAAI;gBACf,WAAW,CAAC,gBAAgB,EAAE,YAAY,WAAW,IAAI;0BAEzD,cAAA,qKAAC;oBACG,KAAK,KAAK,IAAI;oBACd,KAAK,KAAK,KAAK;oBACf,WAAU;;;;;;eAPT,KAAK,IAAI;;;;;QAW1B;;;;;;AAGZ"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/CustomerLayout.tsx"],"sourcesContent":["import Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, useState } from 'react';\r\nimport BottomNavbar from '../../pages/customer/BottomNavbar';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nexport default function CustomerLayout({\r\n  children,\r\n  disablePadding = false,\r\n  fullWidth = false\r\n}: {\r\n  children: React.ReactNode;\r\n  disablePadding?: boolean;\r\n  fullWidth?: boolean\r\n}) {\r\n  const router = useRouter();\r\n  const { is_authenticated, loading } = useAuth();\r\n  const [isDark, setIsDark] = useState<boolean>(false);\r\n\r\n  // 1. THEME LOGIC\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const theme = localStorage.getItem('cc_theme');\r\n      const prefersDark = theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n      setIsDark(prefersDark);\r\n      if (prefersDark) {\r\n        document.body.classList.add('theme-dark');\r\n      } else {\r\n        document.body.classList.remove('theme-dark');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // 2. THEME TOGGLE EXPORT\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      (window as any).toggleCustomerTheme = () => {\r\n        const newTheme = !isDark;\r\n        setIsDark(newTheme);\r\n        if (newTheme) {\r\n          document.body.classList.add('theme-dark');\r\n          localStorage.setItem('cc_theme', 'dark');\r\n        } else {\r\n          document.body.classList.remove('theme-dark');\r\n          localStorage.setItem('cc_theme', 'light');\r\n        }\r\n      };\r\n    }\r\n  }, [isDark]);\r\n\r\n  // 3. GLOBAL AUTHENTICATION GUARD\r\n  useEffect(() => {\r\n    // Prevent auto-logout/redirect loop by waiting for AuthContext to finish loading\r\n    if (!loading) {\r\n      if (!is_authenticated) {\r\n        // No valid session found after revalidation\r\n        router.replace('/customer/signin');\r\n      }\r\n      // Onboarding redirect logic removed - users navigate directly to Home after signup\r\n    }\r\n  }, [is_authenticated, loading, router]);\r\n\r\n  // 4. LOADING STATE\r\n  // Show a clean loading screen while AuthContext verifies the token/cookie\r\n  if (loading) {\r\n    return (\r\n      <div style={{\r\n        height: '100vh',\r\n        width: '100vw',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: isDark ? '#121212' : '#ffffff',\r\n        color: isDark ? '#ffffff' : '#000000',\r\n        fontFamily: 'sans-serif'\r\n      }}>\r\n        <div style={{ textAlign: 'center' }}>\r\n          <p style={{ fontWeight: '500', fontSize: '16px' }}>Securely loading session...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 5. RENDER PROTECTION\r\n  // If not authenticated and finished loading, render nothing while redirecting\r\n  if (!is_authenticated) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`customer-shell ${fullWidth ? 'full-width' : ''}`}>\r\n      <main className={`customer-main ${disablePadding ? 'no-padding' : ''} page-transition`}>\r\n        {children}\r\n      </main>\r\n      <BottomNavbar />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAEe,SAAS,eAAe,EACrC,QAAQ,EACR,iBAAiB,KAAK,EACtB,YAAY,KAAK,EAKlB;IACC,MAAM,SAAS,IAAA,gLAAS;IACxB,MAAM,EAAE,gBAAgB,EAAE,OAAO,EAAE,GAAG,IAAA,8KAAO;IAC7C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAU;IAE9C,iBAAiB;IACjB,IAAA,gHAAS,EAAC;QACR;;IAUF,GAAG,EAAE;IAEL,yBAAyB;IACzB,IAAA,gHAAS,EAAC;QACR;;IAaF,GAAG;QAAC;KAAO;IAEX,iCAAiC;IACjC,IAAA,gHAAS,EAAC;QACR,iFAAiF;QACjF,IAAI,CAAC,SAAS;YACZ,IAAI,CAAC,kBAAkB;gBACrB,4CAA4C;gBAC5C,OAAO,OAAO,CAAC;YACjB;QACA,mFAAmF;QACrF;IACF,GAAG;QAAC;QAAkB;QAAS;KAAO;IAEtC,mBAAmB;IACnB,0EAA0E;IAC1E,IAAI,SAAS;QACX,qBACE,qKAAC;YAAI,OAAO;gBACV,QAAQ;gBACR,OAAO;gBACP,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,iBAAiB,SAAS,YAAY;gBACtC,OAAO,SAAS,YAAY;gBAC5B,YAAY;YACd;sBACE,cAAA,qKAAC;gBAAI,OAAO;oBAAE,WAAW;gBAAS;0BAChC,cAAA,qKAAC;oBAAE,OAAO;wBAAE,YAAY;wBAAO,UAAU;oBAAO;8BAAG;;;;;;;;;;;;;;;;IAI3D;IAEA,uBAAuB;IACvB,8EAA8E;IAC9E,IAAI,CAAC,kBAAkB;QACrB,OAAO;IACT;IAEA,qBACE,qKAAC;QAAI,WAAW,CAAC,eAAe,EAAE,YAAY,eAAe,IAAI;;0BAC/D,qKAAC;gBAAK,WAAW,CAAC,cAAc,EAAE,iBAAiB,eAAe,GAAG,gBAAgB,CAAC;0BACnF;;;;;;0BAEH,qKAAC,yLAAY;;;;;;;;;;;AAGnB"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/profile.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport CustomerLayout from '../../components/customer/CustomerLayout';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nexport default function ProfilePage() {\r\n    const router = useRouter();\r\n\r\n    // Using precise snake_case names from updated context\r\n    const { sign_out, update_theme, user, is_authenticated, loading } = useAuth();\r\n\r\n    const [is_dark, set_is_dark] = useState(false);\r\n\r\n    // Determine profile image source\r\n    const get_profile_image_src = () => {\r\n        if (user?.profile_pic) {\r\n            // Check if it's already a full URL (e.g. Google profile pic)\r\n            if (user.profile_pic.startsWith('http')) {\r\n                return user.profile_pic;\r\n            }\r\n            return `http://localhost:5000${user.profile_pic}`;\r\n        }\r\n        return '/customer/assets/images/default_profile.jpg';\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Theme initialization based on the current body class or storage\r\n        if (typeof window !== 'undefined') {\r\n            const is_dark_mode = document.body.classList.contains('theme-dark') ||\r\n                localStorage.getItem('cc_theme') === 'dark';\r\n            set_is_dark(is_dark_mode);\r\n        }\r\n    }, []);\r\n\r\n    const toggle_theme = () => {\r\n        const new_theme = is_dark ? 'light' : 'dark';\r\n        if (update_theme) {\r\n            update_theme(new_theme);\r\n        }\r\n        set_is_dark(!is_dark);\r\n    };\r\n\r\n    const handle_logout = async () => {\r\n        if (sign_out) {\r\n            await sign_out();\r\n        }\r\n    };\r\n\r\n    const MENU_ITEMS = [\r\n        { label: 'Order History', icon: '/customer/assets/icons/history.svg', action: () => router.push('/customer/orders') },\r\n        { label: 'My Address', icon: '/customer/assets/icons/location.svg', action: () => router.push('/customer/address') },\r\n        { label: 'My Favorite', icon: '/customer/assets/icons/favorite.svg', action: () => router.push('/customer/favorites') },\r\n        { label: 'Sign out', icon: '/customer/assets/icons/logout.svg', action: handle_logout },\r\n    ];\r\n\r\n    // CustomerLayout handles the redirect and loading state. \r\n    // We return null here if not ready to prevent double-renders or data leaks.\r\n    if (loading || !is_authenticated) return null;\r\n\r\n    return (\r\n        <CustomerLayout disablePadding={true} fullWidth={true}>\r\n            <div className=\"profile-page-container\">\r\n                {/* Green Header Background */}\r\n                <div className=\"profile-header-bg\">\r\n                    <h1 className=\"header-title\">My Profile</h1>\r\n                    <button className=\"theme-toggle-mini\" onClick={toggle_theme} aria-label=\"Toggle Theme\">\r\n                        <img\r\n                            src={is_dark ? '/customer/assets/icons/dark.svg' : '/customer/assets/icons/light.svg'}\r\n                            alt={is_dark ? \"Dark Mode\" : \"Light Mode\"}\r\n                            className=\"theme-icon\"\r\n                        />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Overlapping Profile Card */}\r\n                <div className=\"profile-card\">\r\n                    <div className=\"profile-info-row\">\r\n                        <div className=\"profile-avatar-container\">\r\n                            <img\r\n                                src={get_profile_image_src()}\r\n                                alt=\"Profile\"\r\n                                className=\"profile-avatar-img\"\r\n                                onError={(e) => {\r\n                                    const target = e.target as HTMLImageElement;\r\n                                    target.onerror = null; // Prevent infinite loop\r\n                                    target.src = '/customer/assets/images/default_profile.jpg';\r\n                                }}\r\n                            />\r\n                        </div>\r\n                        <div className=\"profile-text-content\">\r\n                            <h2 className=\"profile-name\">{user?.name || 'User'}</h2>\r\n                            <p className=\"profile-email\">{user?.email || 'email@example.com'}</p>\r\n                        </div>\r\n                        <button className=\"edit-profile-btn touchable\" onClick={() => router.push('/customer/edit-profile')}>\r\n                            <img src=\"/customer/assets/icons/edit.svg\" alt=\"Edit\" width={20} height={20} />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* List Section */}\r\n                <div className=\"profile-menu-list\">\r\n                    {MENU_ITEMS.map((item, index) => (\r\n                        <div key={index} className=\"menu-item touchable\" onClick={item.action}>\r\n                            <div className=\"menu-item-left\">\r\n                                <img src={item.icon} alt={item.label} className=\"menu-icon\" />\r\n                                <span className=\"menu-label\">{item.label}</span>\r\n                            </div>\r\n                            <div className=\"menu-chevron\">\r\n                                â€º\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </CustomerLayout>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}