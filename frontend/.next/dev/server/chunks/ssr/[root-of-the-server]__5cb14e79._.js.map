{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/BottomNavbar.tsx"],"sourcesContent":["import { useRouter } from 'next/router';\r\nimport Link from 'next/link';\r\n\r\nconst NAV_ITEMS = [\r\n    { href: '/customer/home', label: 'Home', icon: '/customer/assets/icons/home.svg' },\r\n    { href: '/customer/browse-products', label: 'Search', icon: '/customer/assets/icons/search.svg' },\r\n    { href: '/customer/cart', label: 'Cart', icon: '/customer/assets/icons/cart.svg' },\r\n    { href: '/customer/orders', label: 'Orders', icon: '/customer/assets/icons/order.svg' },\r\n    { href: '/customer/profile', label: 'Profile', icon: '/customer/assets/icons/profile.svg' },\r\n];\r\n\r\nexport default function BottomNavbar() {\r\n    const router = useRouter();\r\n\r\n    return (\r\n        <nav className=\"customer-bottom-nav\">\r\n            {NAV_ITEMS.map((item) => {\r\n                // Precise active check: \r\n                // Home only matches exactly, others match by prefix to handle sub-routes\r\n                const is_active = item.href === '/customer/home'\r\n                    ? router.pathname === item.href\r\n                    : router.pathname.startsWith(item.href);\r\n\r\n                return (\r\n                    <Link\r\n                        key={item.href}\r\n                        href={item.href}\r\n                        className={`bottom-nav-item ${is_active ? 'active' : ''}`}\r\n                    >\r\n                        <img\r\n                            src={item.icon}\r\n                            alt={item.label}\r\n                            className=\"nav-icon-img\"\r\n                        />\r\n                    </Link>\r\n                );\r\n            })}\r\n        </nav>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,YAAY;IACd;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAA6B,OAAO;QAAU,MAAM;IAAoC;IAChG;QAAE,MAAM;QAAkB,OAAO;QAAQ,MAAM;IAAkC;IACjF;QAAE,MAAM;QAAoB,OAAO;QAAU,MAAM;IAAmC;IACtF;QAAE,MAAM;QAAqB,OAAO;QAAW,MAAM;IAAqC;CAC7F;AAEc,SAAS;IACpB,MAAM,SAAS,IAAA,gLAAS;IAExB,qBACI,qKAAC;QAAI,WAAU;kBACV,UAAU,GAAG,CAAC,CAAC;YACZ,yBAAyB;YACzB,yEAAyE;YACzE,MAAM,YAAY,KAAK,IAAI,KAAK,mBAC1B,OAAO,QAAQ,KAAK,KAAK,IAAI,GAC7B,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,IAAI;YAE1C,qBACI,qKAAC,4KAAI;gBAED,MAAM,KAAK,IAAI;gBACf,WAAW,CAAC,gBAAgB,EAAE,YAAY,WAAW,IAAI;0BAEzD,cAAA,qKAAC;oBACG,KAAK,KAAK,IAAI;oBACd,KAAK,KAAK,KAAK;oBACf,WAAU;;;;;;eAPT,KAAK,IAAI;;;;;QAW1B;;;;;;AAGZ"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/CustomerLayout.tsx"],"sourcesContent":["import Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, useState } from 'react';\r\nimport BottomNavbar from '../../pages/customer/BottomNavbar';\r\nimport { useAuth } from '../../context/AuthContext';\r\n\r\nexport default function CustomerLayout({\r\n  children,\r\n  disablePadding = false,\r\n  fullWidth = false\r\n}: {\r\n  children: React.ReactNode;\r\n  disablePadding?: boolean;\r\n  fullWidth?: boolean\r\n}) {\r\n  const router = useRouter();\r\n  const { is_authenticated, loading } = useAuth();\r\n  const [isDark, setIsDark] = useState<boolean>(false);\r\n\r\n  // 1. THEME LOGIC\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const theme = localStorage.getItem('cc_theme');\r\n      const prefersDark = theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n      setIsDark(prefersDark);\r\n      if (prefersDark) {\r\n        document.body.classList.add('theme-dark');\r\n      } else {\r\n        document.body.classList.remove('theme-dark');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // 2. THEME TOGGLE EXPORT\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      (window as any).toggleCustomerTheme = () => {\r\n        const newTheme = !isDark;\r\n        setIsDark(newTheme);\r\n        if (newTheme) {\r\n          document.body.classList.add('theme-dark');\r\n          localStorage.setItem('cc_theme', 'dark');\r\n        } else {\r\n          document.body.classList.remove('theme-dark');\r\n          localStorage.setItem('cc_theme', 'light');\r\n        }\r\n      };\r\n    }\r\n  }, [isDark]);\r\n\r\n  // 3. GLOBAL AUTHENTICATION GUARD\r\n  useEffect(() => {\r\n    // Prevent auto-logout/redirect loop by waiting for AuthContext to finish loading\r\n    if (!loading) {\r\n      if (!is_authenticated) {\r\n        // No valid session found after revalidation\r\n        router.replace('/customer/signin');\r\n      }\r\n      // Onboarding redirect logic removed - users navigate directly to Home after signup\r\n    }\r\n  }, [is_authenticated, loading, router]);\r\n\r\n  // 4. LOADING STATE\r\n  // Show a clean loading screen while AuthContext verifies the token/cookie\r\n  if (loading) {\r\n    return (\r\n      <div style={{\r\n        height: '100vh',\r\n        width: '100vw',\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: isDark ? '#121212' : '#ffffff',\r\n        color: isDark ? '#ffffff' : '#000000',\r\n        fontFamily: 'sans-serif'\r\n      }}>\r\n        <div style={{ textAlign: 'center' }}>\r\n          <p style={{ fontWeight: '500', fontSize: '16px' }}>Securely loading session...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // 5. RENDER PROTECTION\r\n  // If not authenticated and finished loading, render nothing while redirecting\r\n  if (!is_authenticated) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`customer-shell ${fullWidth ? 'full-width' : ''}`}>\r\n      <main className={`customer-main ${disablePadding ? 'no-padding' : ''} page-transition`}>\r\n        {children}\r\n      </main>\r\n      <BottomNavbar />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAEe,SAAS,eAAe,EACrC,QAAQ,EACR,iBAAiB,KAAK,EACtB,YAAY,KAAK,EAKlB;IACC,MAAM,SAAS,IAAA,gLAAS;IACxB,MAAM,EAAE,gBAAgB,EAAE,OAAO,EAAE,GAAG,IAAA,8KAAO;IAC7C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAU;IAE9C,iBAAiB;IACjB,IAAA,gHAAS,EAAC;QACR;;IAUF,GAAG,EAAE;IAEL,yBAAyB;IACzB,IAAA,gHAAS,EAAC;QACR;;IAaF,GAAG;QAAC;KAAO;IAEX,iCAAiC;IACjC,IAAA,gHAAS,EAAC;QACR,iFAAiF;QACjF,IAAI,CAAC,SAAS;YACZ,IAAI,CAAC,kBAAkB;gBACrB,4CAA4C;gBAC5C,OAAO,OAAO,CAAC;YACjB;QACA,mFAAmF;QACrF;IACF,GAAG;QAAC;QAAkB;QAAS;KAAO;IAEtC,mBAAmB;IACnB,0EAA0E;IAC1E,IAAI,SAAS;QACX,qBACE,qKAAC;YAAI,OAAO;gBACV,QAAQ;gBACR,OAAO;gBACP,SAAS;gBACT,gBAAgB;gBAChB,YAAY;gBACZ,iBAAiB,SAAS,YAAY;gBACtC,OAAO,SAAS,YAAY;gBAC5B,YAAY;YACd;sBACE,cAAA,qKAAC;gBAAI,OAAO;oBAAE,WAAW;gBAAS;0BAChC,cAAA,qKAAC;oBAAE,OAAO;wBAAE,YAAY;wBAAO,UAAU;oBAAO;8BAAG;;;;;;;;;;;;;;;;IAI3D;IAEA,uBAAuB;IACvB,8EAA8E;IAC9E,IAAI,CAAC,kBAAkB;QACrB,OAAO;IACT;IAEA,qBACE,qKAAC;QAAI,WAAW,CAAC,eAAe,EAAE,YAAY,eAAe,IAAI;;0BAC/D,qKAAC;gBAAK,WAAW,CAAC,cAAc,EAAE,iBAAiB,eAAe,GAAG,gBAAgB,CAAC;0BACnF;;;;;;0BAEH,qKAAC,yLAAY;;;;;;;;;;;AAGnB"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/home.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport Link from 'next/link';\r\nimport CustomerLayout from '../../components/customer/CustomerLayout';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { useToast } from '../../components/ui/ToastProvider';\r\nimport { useCustomerStore } from '../../context/CustomerStore';\r\nimport { customerFetch } from '../../utils/customerFetch';\r\nimport { SkeletonProductCard } from '../../components/customer/SkeletonProductCard';\r\n\r\n// --- Product Interface ---\r\n\r\ninterface Product {\r\n    _id: string;\r\n    name: string;\r\n    description?: string;\r\n    price: number;\r\n    mrp?: number;\r\n    quantity?: number;\r\n    unit?: string;\r\n    category?: string;\r\n    image?: string;\r\n    isAvailable: boolean;\r\n    stock: number;\r\n    vendor?: {\r\n        _id: string;\r\n        storeName: string;\r\n        ownerName: string;\r\n        email: string;\r\n        isActive: boolean;\r\n    };\r\n    createdAt?: string;\r\n    updatedAt?: string;\r\n}\r\n\r\nconst CATEGORIES = [\r\n    { id: '1', label: 'Grocery', icon: '/customer/assets/icons/grocery.svg', color: '#F3E8FF' },\r\n    { id: '2', label: 'Vegies', icon: '/customer/assets/icons/vegies.svg', color: '#DCFCE7' },\r\n    { id: '3', label: 'Fruits', icon: '/customer/assets/icons/fruits.svg', color: '#FFEDD5' },\r\n    { id: '4', label: 'Bakery', icon: '/customer/assets/icons/bakery.svg', color: '#FEE2E2' },\r\n    { id: '5', label: 'Pharmacy', icon: '/customer/assets/icons/pharmacy.svg', color: '#E0F7FA' },\r\n    { id: '6', label: 'Laundry', icon: '/customer/assets/icons/laundry.svg', color: '#F3F4F6' },\r\n];\r\n\r\nconst SkeletonProductCard = () => (\r\n    <div className=\"product-card\">\r\n        <div className=\"product-card-header\" style={{ justifyContent: 'flex-end', padding: '8px' }}>\r\n            <div className=\"skeleton\" style={{ width: '24px', height: '24px', borderRadius: '50%' }}></div>\r\n        </div>\r\n\r\n        <div className=\"product-image-wrapper\">\r\n            <div className=\"skeleton\" style={{ width: '100%', height: '100%' }}></div>\r\n        </div>\r\n\r\n        <div className=\"product-card-body\">\r\n            <div className=\"skeleton skeleton-text\" style={{ width: '80%', height: '1.2em' }}></div>\r\n            <div className=\"skeleton skeleton-text\" style={{ width: '40%', height: '1em' }}></div>\r\n            <div className=\"product-price-wrapper\">\r\n                <div className=\"skeleton skeleton-text\" style={{ width: '30%', height: '1.2em' }}></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div className=\"product-card-footer\">\r\n            <div className=\"skeleton\" style={{ width: '100%', height: '36px', borderRadius: '6px' }}></div>\r\n        </div>\r\n    </div>\r\n);\r\n\r\nexport default function HomePage() {\r\n    const router = useRouter();\r\n    const { is_authenticated, user, loading } = useAuth();\r\n    const { enqueueToast } = useToast();\r\n\r\n    // Global Cart Store\r\n    const { cart, addToCart, updateQuantity, removeFromCart } = useCustomerStore();\r\n\r\n    const [wishlist, setWishlist] = useState<Set<string>>(new Set());\r\n    // Removed local cart state\r\n    const [products, setProducts] = useState<Product[]>([]);\r\n    const [productsLoading, setProductsLoading] = useState(true);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    const handleSearch = () => {\r\n        if (searchTerm.trim()) {\r\n            router.push(`/customer/browse-products?q=${encodeURIComponent(searchTerm)}`);\r\n        }\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key === 'Enter') {\r\n            handleSearch();\r\n        }\r\n    };\r\n\r\n    // Filter products based on search term\r\n    const filteredProducts = products.filter(p =>\r\n        p.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    // HARD GUARD: Prevents auto-signout by waiting for 'loading' to finish\r\n    useEffect(() => {\r\n        if (!loading && !is_authenticated) {\r\n            router.replace('/customer/signin');\r\n        }\r\n    }, [is_authenticated, loading, router]);\r\n\r\n    // Toast warnings for missing phone and address\r\n    useEffect(() => {\r\n        if (!user || loading) return;\r\n\r\n        // Check for missing phone\r\n        if (!user.phone) {\r\n            enqueueToast('Please add your mobile number', 'warning');\r\n        }\r\n\r\n        // Check for missing addresses - only show if addresses array exists and is empty\r\n        if (user.addresses && user.addresses.length === 0) {\r\n            enqueueToast('Please add your address', 'warning');\r\n        }\r\n    }, [user, loading, enqueueToast]);\r\n\r\n    // Fetch products from API\r\n    useEffect(() => {\r\n        const fetchProducts = async () => {\r\n            try {\r\n                setProductsLoading(true);\r\n                const response = await customerFetch('http://localhost:5000/api/products');\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to fetch products');\r\n                }\r\n\r\n                const data = await response.json();\r\n                // Filter only available products from active vendors\r\n                const availableProducts = data.filter((p: Product) =>\r\n                    p.isAvailable && p.stock > 0 && p.vendor?.isActive !== false\r\n                );\r\n                setProducts(availableProducts);\r\n            } catch (error) {\r\n                console.error('Error fetching products:', error);\r\n                // Only show toast if it's NOT a silent network error (which is handled by customerFetch)\r\n                // But wait, customerFetch returns a hanging promise on network error, so we never reach here!\r\n                // If we reach here, it's a 4xx/5xx or some logic error.\r\n                enqueueToast('Failed to load products', 'error');\r\n                setProducts([]);\r\n            } finally {\r\n                // If network error, the promise hangs, so we NEVER reach finally.\r\n                // Loading stays true. Perfect.\r\n                // If success or other error, we reach here.\r\n                setProductsLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchProducts();\r\n    }, [enqueueToast]);\r\n\r\n    // Fetch wishlist from API\r\n    useEffect(() => {\r\n        const fetchWishlist = async () => {\r\n            try {\r\n                const token = localStorage.getItem('auth_token');\r\n                if (!token) return;\r\n\r\n                const response = await fetch('http://localhost:5000/api/customers/wishlist', {\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    if (response.status === 401) {\r\n                        console.error('Unauthorized: Invalid or expired token');\r\n                        return;\r\n                    }\r\n                    throw new Error('Failed to fetch wishlist');\r\n                }\r\n\r\n                const data = await response.json();\r\n                // Extract product IDs from wishlist items\r\n                const wishlistedProductIds = new Set<string>(\r\n                    data.map((item: { product: { _id: string } }) => item.product._id)\r\n                );\r\n                setWishlist(wishlistedProductIds);\r\n            } catch (error) {\r\n                console.error('Error fetching wishlist:', error);\r\n                // Don't show error toast for wishlist fetch failure - it's not critical\r\n            }\r\n        };\r\n\r\n        fetchWishlist();\r\n    }, []);\r\n\r\n    const toggleWishlist = async (id: string) => {\r\n        const isCurrentlyWishlisted = wishlist.has(id);\r\n\r\n        // Optimistic UI update\r\n        const newWishlist = new Set(wishlist);\r\n        if (isCurrentlyWishlisted) {\r\n            newWishlist.delete(id);\r\n        } else {\r\n            newWishlist.add(id);\r\n        }\r\n        setWishlist(newWishlist);\r\n\r\n        try {\r\n            const token = localStorage.getItem('auth_token');\r\n            if (!token) {\r\n                enqueueToast('Please login to manage wishlist', 'error');\r\n                // Revert optimistic update\r\n                setWishlist(wishlist);\r\n                return;\r\n            }\r\n\r\n            if (isCurrentlyWishlisted) {\r\n                // Remove from wishlist\r\n                const response = await fetch(`http://localhost:5000/api/customers/wishlist/${id}`, {\r\n                    method: 'DELETE',\r\n                    headers: {\r\n                        'Authorization': `Bearer ${token}`\r\n                    }\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to remove from wishlist');\r\n                }\r\n                enqueueToast('Removed from wishlist', 'success');\r\n            } else {\r\n                // Add to wishlist\r\n                const response = await fetch('http://localhost:5000/api/customers/wishlist', {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Authorization': `Bearer ${token}`\r\n                    },\r\n                    body: JSON.stringify({ productId: id })\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to add to wishlist');\r\n                }\r\n                enqueueToast('Added to wishlist', 'success');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error toggling wishlist:', error);\r\n            enqueueToast('Failed to update wishlist', 'error');\r\n            // Revert optimistic update on error\r\n            setWishlist(wishlist);\r\n        }\r\n    };\r\n\r\n    // Helper to get logic from global cart\r\n    const getCartQty = (productId: string) => {\r\n        const item = cart.find(i => i.product._id === productId);\r\n        return item ? item.quantity : 0;\r\n    };\r\n\r\n    // Handler to Add to Cart\r\n    const handleAddToCart = (product: Product) => {\r\n        const productLite = {\r\n            _id: product._id,\r\n            name: product.name,\r\n            price: product.price,\r\n            vendorName: product.vendor?.storeName,\r\n            image: product.image,\r\n            stock: product.stock,\r\n            category: product.category\r\n        };\r\n        addToCart(productLite);\r\n    };\r\n\r\n\r\n\r\n    // Show neutral loading state while AuthContext verifies the token/cookie\r\n    if (loading) {\r\n        return (\r\n            <div style={{\r\n                height: '100vh',\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                backgroundColor: '#fff',\r\n                fontFamily: 'sans-serif',\r\n                color: '#222'\r\n            }}>\r\n                <div style={{ textAlign: 'center' }}>\r\n                    <p style={{ fontWeight: '500' }}>Verifying Session...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Prevents UI flicker while useEffect handles the redirect\r\n    if (!is_authenticated) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <CustomerLayout disablePadding={true}>\r\n            <div className=\"home-container\">\r\n                {/* Section 1: Search Bar */}\r\n                <section className=\"home-search-section\">\r\n                    <div className=\"home-search-container\">\r\n                        <img\r\n                            src=\"/customer/assets/icons/search.svg\"\r\n                            alt=\"Search\"\r\n                            className=\"home-search-icon\"\r\n                            onClick={handleSearch}\r\n                            style={{ cursor: 'pointer' }}\r\n                        />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search keywords..\"\r\n                            className=\"home-search-input\"\r\n                            value={searchTerm}\r\n                            onChange={(e) => setSearchTerm(e.target.value)}\r\n                            onKeyDown={handleKeyDown}\r\n                        />\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Section 2: Hero Banner */}\r\n                <section className=\"home-hero-section\">\r\n                    <img\r\n                        src=\"/customer/assets/images/Vector.png\"\r\n                        alt=\"Trusted Products Banner\"\r\n                        className=\"home-hero-image\"\r\n                    />\r\n                    <div className=\"home-hero-overlay\">\r\n                        <h2 className=\"home-hero-text\">\r\n                            Trusted Products<br />\r\n                            Trusted Vendors\r\n                        </h2>\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Section 3: Categories */}\r\n                <section className=\"home-category-section\">\r\n                    <div className=\"home-category-row\">\r\n                        {CATEGORIES.map((cat) => (\r\n                            <Link\r\n                                key={cat.id}\r\n                                href={`/customer/category?type=${cat.label.toLowerCase()}`}\r\n                                style={{ textDecoration: 'none' }}\r\n                            >\r\n                                <div className=\"home-category-item touchable\">\r\n                                    <div className=\"home-category-icon-wrapper\" style={{ backgroundColor: cat.color }}>\r\n                                        <img src={cat.icon} alt={cat.label} style={{ width: '24px', height: '24px' }} />\r\n                                    </div>\r\n                                    <span className=\"home-category-label\">{cat.label}</span>\r\n                                </div>\r\n                            </Link>\r\n                        ))}\r\n                    </div>\r\n                </section>\r\n\r\n                {/* Section 4 & 5: Featured Products */}\r\n                <section className=\"home-featured-section\">\r\n                    <div className=\"home-section-header\">\r\n                        <h3 className=\"home-section-title\">Featured Products</h3>\r\n                        <span className=\"home-section-action\"><img src=\"/customer/assets/icons/forward.svg\" alt=\"View all\" width={24} height={24} /></span>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"products-grid\">\r\n                        {productsLoading ? (\r\n                            Array.from({ length: 8 }).map((_, idx) => (\r\n                                <SkeletonProductCard key={`skeleton-${idx}`} />\r\n                            ))\r\n                        ) : filteredProducts.length === 0 ? (\r\n                            <div style={{\r\n                                gridColumn: '1 / -1',\r\n                                textAlign: 'center',\r\n                                padding: '2rem',\r\n                                color: '#666'\r\n                            }}>\r\n                                No products found\r\n                            </div>\r\n                        ) : (\r\n                            filteredProducts.map((product) => {\r\n                                const qty = getCartQty(product._id);\r\n                                const isWishlisted = wishlist.has(product._id);\r\n\r\n                                // Calculate discount badge if MRP exists and is higher than price\r\n                                const hasDiscount = product.mrp && product.mrp > product.price;\r\n                                const discountPercent = hasDiscount\r\n                                    ? Math.round(((product.mrp! - product.price) / product.mrp!) * 100)\r\n                                    : 0;\r\n\r\n                                return (\r\n                                    <div key={product._id} className=\"product-card touchable\">\r\n                                        <div className=\"product-card-header\">\r\n                                            {hasDiscount ? (\r\n                                                <span className=\"product-badge discount\">\r\n                                                    -{discountPercent}%\r\n                                                </span>\r\n                                            ) : <span></span>}\r\n                                            <button\r\n                                                className=\"product-wishlist-btn\"\r\n                                                onClick={() => toggleWishlist(product._id)}\r\n                                            >\r\n                                                <img\r\n                                                    src={isWishlisted ? \"/customer/assets/icons/favorite-filled.svg\" : \"/customer/assets/icons/favorite.svg\"}\r\n                                                    alt=\"Wishlist\"\r\n                                                    className={`favorite-heart-icon ${isWishlisted ? 'active' : ''}`}\r\n                                                    style={{ width: '24px', height: '24px' }}\r\n                                                />\r\n                                            </button>\r\n                                        </div>\r\n\r\n                                        <div className=\"product-image-wrapper\" onClick={() => router.push(`/customer/product-detail?id=${product._id}`)}>\r\n                                            <img\r\n                                                src={product.image || '/customer/assets/icons/missing.svg'}\r\n                                                alt={product.name}\r\n                                                className={product.image ? 'product-image' : 'product-image-missing'}\r\n                                            />\r\n                                        </div>\r\n\r\n                                        <div className=\"product-card-body\" onClick={() => router.push(`/customer/product-detail?id=${product._id}`)}>\r\n                                            <h4 className=\"product-name\">{product.name}</h4>\r\n                                            <p className=\"product-qty-label\">\r\n                                                {product.quantity ? `${product.quantity} ${product.unit || ''}` : (product.category || 'Product')}\r\n                                            </p>\r\n                                            <div className=\"product-price-wrapper\">\r\n                                                <span className=\"product-final-price\">₹{product.price.toFixed(2)}</span>\r\n                                                {hasDiscount && (\r\n                                                    <span className=\"product-original-price\" style={{\r\n                                                        textDecoration: 'line-through',\r\n                                                        color: '#999',\r\n                                                        fontSize: '0.85em',\r\n                                                        marginLeft: '0.5rem'\r\n                                                    }}>\r\n                                                        ₹{product.mrp!.toFixed(2)}\r\n                                                    </span>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        <div className=\"product-card-footer\">\r\n                                            {qty === 0 ? (\r\n                                                <button\r\n                                                    className=\"product-add-btn touchable\"\r\n                                                    onClick={() => handleAddToCart(product)}\r\n                                                >\r\n                                                    <img src=\"/customer/assets/icons/bag.svg\" alt=\"Cart\" className=\"product-cart-icon\" />\r\n                                                    Add to cart\r\n                                                </button>\r\n                                            ) : (\r\n                                                <div className=\"product-qty-controls\">\r\n                                                    <button\r\n                                                        className=\"product-qty-btn\"\r\n                                                        onClick={() => {\r\n                                                            if (qty === 1) {\r\n                                                                removeFromCart(product._id);\r\n                                                            } else {\r\n                                                                updateQuantity(product._id, qty - 1);\r\n                                                            }\r\n                                                        }}\r\n                                                    >\r\n                                                        −\r\n                                                    </button>\r\n                                                    <span className=\"product-qty-value\">{qty}</span>\r\n                                                    <button\r\n                                                        className=\"product-qty-btn\"\r\n                                                        onClick={() => updateQuantity(product._id, qty + 1)}\r\n                                                    >\r\n                                                        +\r\n                                                    </button>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                );\r\n                            })\r\n                        )}\r\n                    </div>\r\n                </section>\r\n            </div>\r\n        </CustomerLayout>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}