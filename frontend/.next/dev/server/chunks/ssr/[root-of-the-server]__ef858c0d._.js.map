{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/CustomerLayout.tsx"],"sourcesContent":["import Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect, useState } from 'react';\r\n\r\nconst navLinks = [\r\n  { href: '/customer/dashboard', label: 'Dashboard' },\r\n  { href: '/customer/browse-products', label: 'Browse Products' },\r\n  { href: '/customer/cart', label: 'Cart' },\r\n  { href: '/customer/cart-pro', label: 'Cart-Pro' },\r\n  { href: '/customer/track-order', label: 'Track Orders' },\r\n];\r\n\r\nexport default function CustomerLayout({ children }: { children: React.ReactNode }) {\r\n  const router = useRouter();\r\n  const [isDark, setIsDark] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    // Load theme preference\r\n    if (typeof window !== 'undefined') {\r\n      const theme = localStorage.getItem('cc_theme');\r\n      const prefersDark = theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches);\r\n      setIsDark(prefersDark);\r\n      if (prefersDark) {\r\n        document.body.classList.add('theme-dark');\r\n      } else {\r\n        document.body.classList.remove('theme-dark');\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const toggleTheme = () => {\r\n    const newTheme = !isDark;\r\n    setIsDark(newTheme);\r\n    if (newTheme) {\r\n      document.body.classList.add('theme-dark');\r\n      localStorage.setItem('cc_theme', 'dark');\r\n    } else {\r\n      document.body.classList.remove('theme-dark');\r\n      localStorage.setItem('cc_theme', 'light');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"customer-shell\">\r\n      <header className=\"customer-topbar\">\r\n        <div className=\"customer-brand\">Customer Test Console</div>\r\n        <nav className=\"customer-nav\">\r\n          {navLinks.map((link) => {\r\n            const active = router.pathname === link.href;\r\n            return (\r\n              <Link key={link.href} href={link.href} className={`customer-nav-link ${active ? 'active' : ''}`}>\r\n                {link.label}\r\n              </Link>\r\n            );\r\n          })}\r\n          <button\r\n            className=\"customer-theme-toggle\"\r\n            onClick={toggleTheme}\r\n            title={isDark ? 'Switch to light mode' : 'Switch to dark mode'}\r\n            aria-label=\"Toggle theme\"\r\n          >\r\n            {isDark ? '‚òÄÔ∏è' : 'üåô'}\r\n          </button>\r\n        </nav>\r\n      </header>\r\n      <main className=\"customer-main\">{children}</main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEA,MAAM,WAAW;IACf;QAAE,MAAM;QAAuB,OAAO;IAAY;IAClD;QAAE,MAAM;QAA6B,OAAO;IAAkB;IAC9D;QAAE,MAAM;QAAkB,OAAO;IAAO;IACxC;QAAE,MAAM;QAAsB,OAAO;IAAW;IAChD;QAAE,MAAM;QAAyB,OAAO;IAAe;CACxD;AAEc,SAAS,eAAe,EAAE,QAAQ,EAAiC;IAChF,MAAM,SAAS,IAAA,gLAAS;IACxB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAU;IAE9C,IAAA,gHAAS,EAAC;QACR,wBAAwB;QACxB;;IAUF,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,MAAM,WAAW,CAAC;QAClB,UAAU;QACV,IAAI,UAAU;YACZ,SAAS,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;YAC5B,aAAa,OAAO,CAAC,YAAY;QACnC,OAAO;YACL,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC/B,aAAa,OAAO,CAAC,YAAY;QACnC;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAO,WAAU;;kCAChB,qKAAC;wBAAI,WAAU;kCAAiB;;;;;;kCAChC,qKAAC;wBAAI,WAAU;;4BACZ,SAAS,GAAG,CAAC,CAAC;gCACb,MAAM,SAAS,OAAO,QAAQ,KAAK,KAAK,IAAI;gCAC5C,qBACE,qKAAC,4KAAI;oCAAiB,MAAM,KAAK,IAAI;oCAAE,WAAW,CAAC,kBAAkB,EAAE,SAAS,WAAW,IAAI;8CAC5F,KAAK,KAAK;mCADF,KAAK,IAAI;;;;;4BAIxB;0CACA,qKAAC;gCACC,WAAU;gCACV,SAAS;gCACT,OAAO,SAAS,yBAAyB;gCACzC,cAAW;0CAEV,SAAS,OAAO;;;;;;;;;;;;;;;;;;0BAIvB,qKAAC;gBAAK,WAAU;0BAAiB;;;;;;;;;;;;AAGvC"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/browse-products.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\r\nimport CustomerLayout from '../../components/customer/CustomerLayout';\r\nimport { useCustomerStore } from '../../context/CustomerStore';\r\nimport { useToast } from '../../components/ui/ToastProvider';\r\n\r\ninterface Product {\r\n  _id: string;\r\n  name: string;\r\n  price: number;\r\n  image?: string;\r\n  vendor?: { name?: string };\r\n  isAvailable?: boolean;\r\n  stock?: number;\r\n}\r\n\r\nconst API_BASE = 'http://localhost:5000/api';\r\n\r\nconst CATEGORIES = [\r\n  { name: 'Grocery', icon: 'üß∫', color: '#EDE7F6', iconColor: '#7E57C2' },\r\n  { name: 'Vegies', icon: 'ü•¨', color: '#E8F5E9', iconColor: '#4CAF50' },\r\n  { name: 'Fruits', icon: 'üçé', color: '#FFEBEE', iconColor: '#EF5350' },\r\n  { name: 'Bakery', icon: 'üçî', color: '#FCE4EC', iconColor: '#EC407A' }, // Using burger as placeholder for Bakery/Fast food\r\n  { name: 'Laundry', icon: 'üëï', color: '#EDE7F6', iconColor: '#5E35B1' }, // Placeholder\r\n];\r\n\r\nexport default function BrowseProducts() {\r\n  const { addToCart, updateQuantity, ensureCustomerId, cart } = useCustomerStore();\r\n  const { pushToast } = useToast();\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      await ensureCustomerId();\r\n      try {\r\n        const res = await fetch(`${API_BASE}/products`);\r\n        if (!res.ok) throw new Error('Failed to fetch products');\r\n        const data = await res.json();\r\n        const available = data.filter((p: Product) => p.isAvailable !== false && (p.stock ?? 0) > 0);\r\n        setProducts(available);\r\n      } catch (err: any) {\r\n        setError(err.message || 'Failed to load products');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n  }, [ensureCustomerId]);\r\n\r\n  const cartMap = useMemo(() => {\r\n    const map = new Map<string, number>();\r\n    cart.forEach((item) => map.set(item.product._id, item.quantity));\r\n    return map;\r\n  }, [cart]);\r\n\r\n  const handleAdd = (product: Product) => {\r\n    const stock = product.stock ?? 0;\r\n    const currentQty = cartMap.get(product._id) || 0;\r\n    if (stock <= 0) return;\r\n    if (currentQty >= stock) {\r\n      pushToast({ type: 'warning', title: 'Stock limit', message: `Only ${stock} left for ${product.name}` });\r\n      return;\r\n    }\r\n\r\n    // If not in cart, add with qty 1. If in cart, we use the quantity controls instead usually.\r\n    // But for the main button \"Add to Cart\", we just add 1.\r\n    addToCart({\r\n      _id: product._id,\r\n      name: product.name,\r\n      price: product.price,\r\n      image: product.image,\r\n      vendorName: product.vendor?.name,\r\n      stock: product.stock,\r\n    }, stock);\r\n  };\r\n\r\n  const updateItemQty = (product: Product, delta: number) => {\r\n    const currentQty = cartMap.get(product._id) || 0;\r\n    const newQty = currentQty + delta;\r\n    if (newQty <= 0) {\r\n      // Remove functionality if needed, or just set to 0 (which customer store handles as remove usually? Verify store logic)\r\n      // Store logic: if nextQty <= 0 return null (filter out). So yes, removes.\r\n      updateQuantity(product._id, 0); // Logic says updateQuantity(id, qty).\r\n    } else {\r\n      updateQuantity(product._id, newQty);\r\n    }\r\n  };\r\n\r\n  const filteredProducts = products.filter(p => p.name.toLowerCase().includes(searchTerm.toLowerCase()));\r\n\r\n  return (\r\n    <CustomerLayout>\r\n      <div className=\"browse-page\">\r\n        {/* Search Bar */}\r\n        <div className=\"search-container\">\r\n          <div className=\"search-bar\">\r\n            <span className=\"search-icon\">üîç</span>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search keywords..\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Categories */}\r\n        <div className=\"categories-list\">\r\n          {CATEGORIES.map((cat) => (\r\n            <div key={cat.name} className=\"category-item\">\r\n              <div className=\"cat-icon-circle\" style={{ backgroundColor: cat.color }}>\r\n                <span style={{ color: cat.iconColor }}>{cat.icon}</span>\r\n              </div>\r\n              <span className=\"cat-name\">{cat.name}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <h2 className=\"section-title\">Featured Products <span style={{ fontSize: '20px', float: 'right' }}>‚ùØ</span></h2>\r\n\r\n        {loading && <div className=\"page-state\">Loading products‚Ä¶</div>}\r\n        {error && !loading && <div className=\"page-state error\">{error}</div>}\r\n\r\n        {!loading && !error && (\r\n          <div className=\"products-grid\">\r\n            {filteredProducts.map((product, index) => {\r\n              const qtyInCart = cartMap.get(product._id) || 0;\r\n              const isEven = index % 2 === 0;\r\n\r\n              // Dummy Logic for tags\r\n              const discount = isEven ? '-16%' : null;\r\n              const isNew = !isEven;\r\n\r\n              return (\r\n                <article key={product._id} className=\"product-card\">\r\n                  <div className=\"card-top\">\r\n                    {discount && <span className=\"tag discount\">{discount}</span>}\r\n                    {isNew && <span className=\"tag new\">NEW</span>}\r\n                    <button className=\"wishlist-btn\">‚ô°</button>\r\n\r\n                    <div className=\"product-image-wrap\">\r\n                      {product.image ? (\r\n                        <img src={product.image} alt={product.name} className=\"product-image\" />\r\n                      ) : (\r\n                        <div className=\"image-placeholder\" />\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"product-info\">\r\n                    <h3 className=\"product-name\">{product.name}</h3>\r\n                    <p className=\"product-qty-label\">Quantity</p>\r\n                    <p className=\"product-price\">‚Çπ{product.price.toFixed(2)}</p>\r\n                  </div>\r\n\r\n                  <div className=\"card-actions\">\r\n                    {qtyInCart > 0 ? (\r\n                      <div className=\"qty-controls\">\r\n                        <button className=\"qty-btn\" onClick={() => updateItemQty(product, 1)}>+</button>\r\n                        <span className=\"qty-val\">{qtyInCart}</span>\r\n                        <button className=\"qty-btn\" onClick={() => updateItemQty(product, -1)}>‚àí</button>\r\n                      </div>\r\n                    ) : (\r\n                      <button\r\n                        className=\"add-to-cart-btn\"\r\n                        onClick={() => handleAdd(product)}\r\n                        disabled={(product.stock ?? 0) <= 0}\r\n                      >\r\n                        <span className=\"cart-icon\">üõçÔ∏è</span> Add to cart\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </article>\r\n              );\r\n            })}\r\n            {filteredProducts.length === 0 && <div className=\"page-state\">No products found.</div>}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </CustomerLayout>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}