{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/components/customer/CustomerLayout.tsx"],"sourcesContent":["import Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport './CustomerLayout.css';\r\n\r\nconst navLinks = [\r\n  { href: '/customer/dashboard', label: 'Dashboard' },\r\n  { href: '/customer/browse-products', label: 'Browse Products' },\r\n  { href: '/customer/cart', label: 'Cart' },\r\n  { href: '/customer/track-order', label: 'Track Orders' },\r\n];\r\n\r\nexport default function CustomerLayout({ children }: { children: React.ReactNode }) {\r\n  const router = useRouter();\r\n\r\n  return (\r\n    <div className=\"customer-shell\">\r\n      <header className=\"customer-topbar\">\r\n        <div className=\"customer-brand\">Customer Test Console</div>\r\n        <nav className=\"customer-nav\">\r\n          {navLinks.map((link) => {\r\n            const active = router.pathname === link.href;\r\n            return (\r\n              <Link key={link.href} href={link.href} className={`customer-nav-link ${active ? 'active' : ''}`}>\r\n                {link.label}\r\n              </Link>\r\n            );\r\n          })}\r\n        </nav>\r\n      </header>\r\n      <main className=\"customer-main\">{children}</main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;AAGA,MAAM,WAAW;IACf;QAAE,MAAM;QAAuB,OAAO;IAAY;IAClD;QAAE,MAAM;QAA6B,OAAO;IAAkB;IAC9D;QAAE,MAAM;QAAkB,OAAO;IAAO;IACxC;QAAE,MAAM;QAAyB,OAAO;IAAe;CACxD;AAEc,SAAS,eAAe,EAAE,QAAQ,EAAiC;IAChF,MAAM,SAAS,IAAA,gLAAS;IAExB,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAO,WAAU;;kCAChB,qKAAC;wBAAI,WAAU;kCAAiB;;;;;;kCAChC,qKAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC;4BACb,MAAM,SAAS,OAAO,QAAQ,KAAK,KAAK,IAAI;4BAC5C,qBACE,qKAAC,4KAAI;gCAAiB,MAAM,KAAK,IAAI;gCAAE,WAAW,CAAC,kBAAkB,EAAE,SAAS,WAAW,IAAI;0CAC5F,KAAK,KAAK;+BADF,KAAK,IAAI;;;;;wBAIxB;;;;;;;;;;;;0BAGJ,qKAAC;gBAAK,WAAU;0BAAiB;;;;;;;;;;;;AAGvC"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/context/CustomerStore.tsx"],"sourcesContent":["import { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\n\r\nexport interface ProductLite {\r\n  _id: string;\r\n  name: string;\r\n  price: number;\r\n  vendorName?: string;\r\n  image?: string;\r\n}\r\n\r\nexport interface CartItem {\r\n  product: ProductLite;\r\n  quantity: number;\r\n}\r\n\r\ninterface CustomerStoreState {\r\n  customerId: string | null;\r\n  cart: CartItem[];\r\n  ensureCustomerId: () => Promise<string | null>;\r\n  addToCart: (product: ProductLite) => void;\r\n  updateQuantity: (productId: string, quantity: number) => void;\r\n  removeFromCart: (productId: string) => void;\r\n  clearCart: () => void;\r\n  totalPrice: number;\r\n  totalItems: number;\r\n}\r\n\r\nconst CustomerStoreContext = createContext<CustomerStoreState | undefined>(undefined);\r\n\r\nconst API_BASE = 'http://localhost:5000/api';\r\nconst STORAGE_CART_KEY = 'cc_customer_cart';\r\nconst STORAGE_CUSTOMER_KEY = 'cc_customer_id';\r\nconst TEST_CUSTOMER_EMAIL = 'test.customer@demo.com';\r\n\r\nexport function CustomerStoreProvider({ children }: { children: React.ReactNode }) {\r\n  const [customerId, setCustomerId] = useState<string | null>(null);\r\n  const [cart, setCart] = useState<CartItem[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    const savedCart = localStorage.getItem(STORAGE_CART_KEY);\r\n    const savedCustomer = localStorage.getItem(STORAGE_CUSTOMER_KEY);\r\n    if (savedCart) {\r\n      try {\r\n        setCart(JSON.parse(savedCart));\r\n      } catch (_) {\r\n        setCart([]);\r\n      }\r\n    }\r\n    if (savedCustomer) {\r\n      setCustomerId(savedCustomer);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    localStorage.setItem(STORAGE_CART_KEY, JSON.stringify(cart));\r\n  }, [cart]);\r\n\r\n  const ensureCustomerId = async (): Promise<string | null> => {\r\n    if (customerId) return customerId;\r\n    if (typeof window === 'undefined') return null;\r\n\r\n    const stored = localStorage.getItem(STORAGE_CUSTOMER_KEY);\r\n    if (stored) {\r\n      setCustomerId(stored);\r\n      return stored;\r\n    }\r\n\r\n    try {\r\n      const listRes = await fetch(`${API_BASE}/customers`);\r\n      if (listRes.ok) {\r\n        const customers = await listRes.json();\r\n        const existing = customers.find((c: any) => c.email === TEST_CUSTOMER_EMAIL) || customers[0];\r\n        if (existing) {\r\n          localStorage.setItem(STORAGE_CUSTOMER_KEY, existing._id);\r\n          setCustomerId(existing._id);\r\n          return existing._id;\r\n        }\r\n      }\r\n    } catch (_) {\r\n      // ignore and attempt creation\r\n    }\r\n\r\n    try {\r\n      const createRes = await fetch(`${API_BASE}/customers`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          name: 'Test Customer',\r\n          email: TEST_CUSTOMER_EMAIL,\r\n          phone: '9999999999',\r\n          isActive: true,\r\n        }),\r\n      });\r\n      if (!createRes.ok) throw new Error('Failed to create test customer');\r\n      const customer = await createRes.json();\r\n      localStorage.setItem(STORAGE_CUSTOMER_KEY, customer._id);\r\n      setCustomerId(customer._id);\r\n      return customer._id;\r\n    } catch (error) {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const addToCart = (product: ProductLite) => {\r\n    setCart((prev) => {\r\n      const existing = prev.find((item) => item.product._id === product._id);\r\n      if (existing) {\r\n        return prev.map((item) =>\r\n          item.product._id === product._id ? { ...item, quantity: item.quantity + 1 } : item\r\n        );\r\n      }\r\n      return [...prev, { product, quantity: 1 }];\r\n    });\r\n  };\r\n\r\n  const updateQuantity = (productId: string, quantity: number) => {\r\n    setCart((prev) => {\r\n      if (quantity <= 0) return prev.filter((item) => item.product._id !== productId);\r\n      return prev.map((item) => (item.product._id === productId ? { ...item, quantity } : item));\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (productId: string) => {\r\n    setCart((prev) => prev.filter((item) => item.product._id !== productId));\r\n  };\r\n\r\n  const clearCart = () => setCart([]);\r\n\r\n  const totalPrice = useMemo(\r\n    () => cart.reduce((sum, item) => sum + item.product.price * item.quantity, 0),\r\n    [cart]\r\n  );\r\n\r\n  const totalItems = useMemo(\r\n    () => cart.reduce((sum, item) => sum + item.quantity, 0),\r\n    [cart]\r\n  );\r\n\r\n  const value: CustomerStoreState = {\r\n    customerId,\r\n    cart,\r\n    ensureCustomerId,\r\n    addToCart,\r\n    updateQuantity,\r\n    removeFromCart,\r\n    clearCart,\r\n    totalPrice,\r\n    totalItems,\r\n  };\r\n\r\n  return <CustomerStoreContext.Provider value={value}>{children}</CustomerStoreContext.Provider>;\r\n}\r\n\r\nexport const useCustomerStore = () => {\r\n  const ctx = useContext(CustomerStoreContext);\r\n  if (!ctx) throw new Error('useCustomerStore must be used within CustomerStoreProvider');\r\n  return ctx;\r\n};\r\n"],"names":[],"mappings":";;;;;;;AAAA;;;AA2BA,MAAM,qCAAuB,IAAA,oHAAa,EAAiC;AAE3E,MAAM,WAAW;AACjB,MAAM,mBAAmB;AACzB,MAAM,uBAAuB;AAC7B,MAAM,sBAAsB;AAErB,SAAS,sBAAsB,EAAE,QAAQ,EAAiC;IAC/E,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,+GAAQ,EAAgB;IAC5D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAa,EAAE;IAE/C,IAAA,gHAAS,EAAC;QACR,wCAAmC;;;QACnC,MAAM;QACN,MAAM;IAWR,GAAG,EAAE;IAEL,IAAA,gHAAS,EAAC;QACR,wCAAmC;;;IAErC,GAAG;QAAC;KAAK;IAET,MAAM,mBAAmB;QACvB,IAAI,YAAY,OAAO;QACvB,wCAAmC,OAAO;;;QAE1C,MAAM;IAwCR;IAEA,MAAM,YAAY,CAAC;QACjB,QAAQ,CAAC;YACP,MAAM,WAAW,KAAK,IAAI,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,GAAG,KAAK,QAAQ,GAAG;YACrE,IAAI,UAAU;gBACZ,OAAO,KAAK,GAAG,CAAC,CAAC,OACf,KAAK,OAAO,CAAC,GAAG,KAAK,QAAQ,GAAG,GAAG;wBAAE,GAAG,IAAI;wBAAE,UAAU,KAAK,QAAQ,GAAG;oBAAE,IAAI;YAElF;YACA,OAAO;mBAAI;gBAAM;oBAAE;oBAAS,UAAU;gBAAE;aAAE;QAC5C;IACF;IAEA,MAAM,iBAAiB,CAAC,WAAmB;QACzC,QAAQ,CAAC;YACP,IAAI,YAAY,GAAG,OAAO,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,GAAG,KAAK;YACrE,OAAO,KAAK,GAAG,CAAC,CAAC,OAAU,KAAK,OAAO,CAAC,GAAG,KAAK,YAAY;oBAAE,GAAG,IAAI;oBAAE;gBAAS,IAAI;QACtF;IACF;IAEA,MAAM,iBAAiB,CAAC;QACtB,QAAQ,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,GAAG,KAAK;IAC/D;IAEA,MAAM,YAAY,IAAM,QAAQ,EAAE;IAElC,MAAM,aAAa,IAAA,8GAAO,EACxB,IAAM,KAAK,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,OAAO,CAAC,KAAK,GAAG,KAAK,QAAQ,EAAE,IAC3E;QAAC;KAAK;IAGR,MAAM,aAAa,IAAA,8GAAO,EACxB,IAAM,KAAK,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,QAAQ,EAAE,IACtD;QAAC;KAAK;IAGR,MAAM,QAA4B;QAChC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACF;IAEA,qBAAO,qKAAC,qBAAqB,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AACvD;AAEO,MAAM,mBAAmB;IAC9B,MAAM,MAAM,IAAA,iHAAU,EAAC;IACvB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAC1B,OAAO;AACT"}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/vigne/Desktop/Community-Cart/frontend/src/pages/customer/dashboard.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport CustomerLayout from '../../components/customer/CustomerLayout';\r\nimport { useCustomerStore } from '../../context/CustomerStore';\r\nimport './dashboard.css';\r\n\r\ninterface OrderSummary {\r\n  _id: string;\r\n  status: string;\r\n  createdAt: string;\r\n}\r\n\r\nexport default function CustomerDashboard() {\r\n  const { ensureCustomerId } = useCustomerStore();\r\n  const [orders, setOrders] = useState<OrderSummary[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      const cid = await ensureCustomerId();\r\n      if (!cid) {\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      try {\r\n        const res = await fetch('http://localhost:5000/api/orders');\r\n        if (!res.ok) throw new Error('Failed to fetch orders');\r\n        const data = await res.json();\r\n        const mine = data.filter((o: any) => o.customerId && (o.customerId._id === cid || o.customerId === cid));\r\n        setOrders(mine);\r\n      } catch (_) {\r\n        setOrders([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n  }, [ensureCustomerId]);\r\n\r\n  const totalOrders = orders.length;\r\n  const lastOrder = useMemo(() => {\r\n    if (!orders.length) return null;\r\n    return [...orders].sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())[0];\r\n  }, [orders]);\r\n\r\n  return (\r\n    <CustomerLayout>\r\n      <div className=\"customer-dash\">\r\n        <header className=\"dash-header\">\r\n          <div>\r\n            <p className=\"dash-kicker\">Customer Test Dashboard</p>\r\n            <h1 className=\"dash-title\">Welcome back</h1>\r\n            <p className=\"dash-subtitle\">Use this sandbox to place and track test orders.</p>\r\n          </div>\r\n          <div className=\"dash-actions\">\r\n            <Link href=\"/customer/browse-products\" className=\"btn-primary\">Browse Products</Link>\r\n            <Link href=\"/customer/cart\" className=\"btn-secondary\">View Cart</Link>\r\n          </div>\r\n        </header>\r\n\r\n        {loading ? (\r\n          <div className=\"dash-loading\">Loading your summary…</div>\r\n        ) : (\r\n          <div className=\"dash-grid\">\r\n            <div className=\"dash-card\">\r\n              <p className=\"card-label\">Total Orders</p>\r\n              <p className=\"card-value\">{totalOrders}</p>\r\n              <p className=\"card-hint\">All orders created by this test customer</p>\r\n            </div>\r\n            <div className=\"dash-card\">\r\n              <p className=\"card-label\">Last Order Status</p>\r\n              <p className=\"card-value\">{lastOrder ? lastOrder.status : '—'}</p>\r\n              <p className=\"card-hint\">Most recent order placed</p>\r\n            </div>\r\n            <div className=\"dash-card\">\r\n              <p className=\"card-label\">Quick Links</p>\r\n              <div className=\"quick-links\">\r\n                <Link href=\"/customer/place-order\" className=\"link-ghost\">Place Order</Link>\r\n                <Link href=\"/customer/track-order\" className=\"link-ghost\">Track Orders</Link>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </CustomerLayout>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;AASe,SAAS;IACtB,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAA,yLAAgB;IAC7C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAiB,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,IAAA,gHAAS,EAAC;QACR,MAAM,OAAO;YACX,MAAM,MAAM,MAAM;YAClB,IAAI,CAAC,KAAK;gBACR,WAAW;gBACX;YACF;YACA,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;gBAC7B,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,OAAO,KAAK,MAAM,CAAC,CAAC,IAAW,EAAE,UAAU,IAAI,CAAC,EAAE,UAAU,CAAC,GAAG,KAAK,OAAO,EAAE,UAAU,KAAK,GAAG;gBACtG,UAAU;YACZ,EAAE,OAAO,GAAG;gBACV,UAAU,EAAE;YACd,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG;QAAC;KAAiB;IAErB,MAAM,cAAc,OAAO,MAAM;IACjC,MAAM,YAAY,IAAA,8GAAO,EAAC;QACxB,IAAI,CAAC,OAAO,MAAM,EAAE,OAAO;QAC3B,OAAO;eAAI;SAAO,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,GAAG,CAAC,EAAE;IACzG,GAAG;QAAC;KAAO;IAEX,qBACE,qKAAC,gMAAc;kBACb,cAAA,qKAAC;YAAI,WAAU;;8BACb,qKAAC;oBAAO,WAAU;;sCAChB,qKAAC;;8CACC,qKAAC;oCAAE,WAAU;8CAAc;;;;;;8CAC3B,qKAAC;oCAAG,WAAU;8CAAa;;;;;;8CAC3B,qKAAC;oCAAE,WAAU;8CAAgB;;;;;;;;;;;;sCAE/B,qKAAC;4BAAI,WAAU;;8CACb,qKAAC,4KAAI;oCAAC,MAAK;oCAA4B,WAAU;8CAAc;;;;;;8CAC/D,qKAAC,4KAAI;oCAAC,MAAK;oCAAiB,WAAU;8CAAgB;;;;;;;;;;;;;;;;;;gBAIzD,wBACC,qKAAC;oBAAI,WAAU;8BAAe;;;;;yCAE9B,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAE,WAAU;8CAAa;;;;;;8CAC1B,qKAAC;oCAAE,WAAU;8CAAc;;;;;;8CAC3B,qKAAC;oCAAE,WAAU;8CAAY;;;;;;;;;;;;sCAE3B,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAE,WAAU;8CAAa;;;;;;8CAC1B,qKAAC;oCAAE,WAAU;8CAAc,YAAY,UAAU,MAAM,GAAG;;;;;;8CAC1D,qKAAC;oCAAE,WAAU;8CAAY;;;;;;;;;;;;sCAE3B,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAE,WAAU;8CAAa;;;;;;8CAC1B,qKAAC;oCAAI,WAAU;;sDACb,qKAAC,4KAAI;4CAAC,MAAK;4CAAwB,WAAU;sDAAa;;;;;;sDAC1D,qKAAC,4KAAI;4CAAC,MAAK;4CAAwB,WAAU;sDAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ1E"}}]
}