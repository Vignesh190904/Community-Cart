const { supabase } = require('./src/config/supabaseClient');

async function checkViews() {
  console.log('üîç Checking database views...\n');

  try {
    // Check vendor_metrics view
    console.log('1. Checking vendor_metrics view...');
    const { data: vendorMetrics, error: vmError } = await supabase
      .from('vendor_metrics')
      .select('*')
      .limit(1);

    if (vmError) {
      console.log('‚ùå vendor_metrics view error:', vmError.message);
    } else {
      console.log('‚úÖ vendor_metrics view exists');
      console.log('   Sample data:', vendorMetrics);
    }

    // Check monthly_revenue view
    console.log('\n2. Checking monthly_revenue view...');
    const { data: monthlyRevenue, error: mrError } = await supabase
      .from('monthly_revenue')
      .select('*')
      .limit(1);

    if (mrError) {
      console.log('‚ùå monthly_revenue view error:', mrError.message);
    } else {
      console.log('‚úÖ monthly_revenue view exists');
      console.log('   Sample data:', monthlyRevenue);
    }

    // Check if views exist in information_schema
    console.log('\n3. Checking information_schema for views...');
    const { data: views, error: viewsError } = await supabase
      .rpc('get_views');

    if (viewsError) {
      console.log('‚ùå Error checking views:', viewsError.message);
    } else {
      console.log('‚úÖ Available views:', views);
    }

  } catch (error) {
    console.error('‚ùå Error:', error.message);
  }
}

checkViews();
